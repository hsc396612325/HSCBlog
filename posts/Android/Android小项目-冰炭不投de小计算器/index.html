<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Android小项目————冰炭不投de小计算器 | 冰炭不投day的博客</title>
    <meta property="og:title" content="Android小项目————冰炭不投de小计算器 - 冰炭不投day的博客">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2018-07-04T22:40:54&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2018-07-04T22:40:54&#43;08:00'>
        
    <meta name="Keywords" content="Android 冰炭不投day">
    <meta name="description" content="Android小项目————冰炭不投de小计算器">
        
    <meta name="author" content="冰炭不投day">
    <meta property="og:url" content="http://blog.bingtan.online/posts/Android/Android%E5%B0%8F%E9%A1%B9%E7%9B%AE-%E5%86%B0%E7%82%AD%E4%B8%8D%E6%8A%95de%E5%B0%8F%E8%AE%A1%E7%AE%97%E5%99%A8/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-4031353640611810",
        enable_page_level_ads: true
    });
    </script>
    


    
    
        <link rel="stylesheet" href='/css/douban.css'>
    
        <link rel="stylesheet" href='/css/other.css'>
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="http://blog.bingtan.online">
                        冰炭不投day的博客
                    </a>
                
                <p class="description">若向往 我敢往</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="http://blog.bingtan.online">首页</a>
                    
                    <a  href="http://blog.bingtan.online/tools/" title="工具">工具</a>
                    
                    <a  href="http://blog.bingtan.online/archives/" title="归档">归档</a>
                    
                    <a  href="http://blog.bingtan.online/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">Android小项目————冰炭不投de小计算器</h1>
        </header>
        <date class="post-meta meta-date">
            2018年7月4日
        </date>
        
        <div class="post-meta">
            <span>|</span>
            
            <span class="meta-category"><a href='http://blog.bingtan.online/categories/Android'>Android</a></span>
            
        </div>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        

        
        
        <div class="post-content">
            <h3 id="一前言">一.前言</h3>
<p>这是我首个使用java写的app，也在学习郭霖老师的第一行代码和李刚老师的疯狂java讲义之时，进行的练习之作，刚刚学习java和android，有些地方可能并没有做的很完善，希望大家可以多多包涵。</p>
<h3 id="二环境准备和所需知识点">二.环境准备和所需知识点</h3>
<h4 id="1-编译器andriod-studio">1. 编译器：Andriod Studio</h4>
<h4 id="2-新建一个项目并选择全部默认">2. 新建一个项目并选择全部默认</h4>
<h4 id="3-知识点">3. 知识点：</h4>
<ul>
<li>对Android界面和布局的了解</li>
<li>对Android活动的了解</li>
<li>对Java基础知识的了解（面向对象，集合）</li>
<li>算法：中缀表达式转后缀表达式，后缀表达式计算结果</li>
</ul>
<h3 id="三实现效果和界面运行截图">三.实现效果和界面，运行截图</h3>
<h4 id="1实现效果">1.实现效果：</h4>
<ul>
<li>加减混合运算（浮点数）</li>
<li>可带括号</li>
<li>可保留上次计算结果</li>
</ul>
<h4 id="2效果截图">2.效果截图</h4>
<p><img src="/image/Android/8_0.png" alt="这里写图片描述">
<img src="/image/Android/8_1.png" alt="这里写图片描述"></p>
<h3 id="四界面的编写">四.界面的编写</h3>
<h4 id="1布局">1.布局</h4>
<ul>
<li>我使用的是百分比布局，使用前在app/build.gradle文件中添加一条语句</li>
</ul>
<pre><code>compile 'com.android.support:percent:24.2.1'
</code></pre><ul>
<li>修改的地方：
<img src="/image/Android/8_2.png" alt="图片"></li>
<li>修改后，点击弹出了提醒语句中的 Sync Now
<img src="/image/Android/8_3.png" alt="这里写图片描述"></li>
</ul>
<h4 id="2关于颜色搭配推荐一个网站网站地址httpwwwcnblogscomandroid100pandroid-setalphahtml">2.关于颜色搭配，推荐一个网站<a href="http://www.cnblogs.com/android100/p/android-setalpha.html">网站地址</a></h4>
<h4 id="3界面的编写">3.界面的编写</h4>
<ol>
<li>所使用的控件：TextView Buttom</li>
<li>修改Activity_main.xml文件代码，内容如下</li>
</ol>
<pre><code>&lt;android.support.percent.PercentRelativeLayout
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;&gt;

    &lt;Button
        android:id=&quot;@+id/buttonEqual&quot;
        android:text=&quot;＝&quot;
        android:layout_alignParentRight=&quot;true&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#FFFFCD&quot;
        android:layout_alignParentBottom=&quot;true&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;

    &lt;Button
        android:id=&quot;@+id/buttonAdd&quot;
        android:text=&quot;＋&quot;
        android:layout_alignParentRight=&quot;true&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F0FFFF&quot;
        android:layout_above=&quot;@id/buttonEqual&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/buttonSign&quot;
        android:text=&quot;－&quot;
        android:layout_alignParentRight=&quot;true&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F0FFFF&quot;
        android:layout_above=&quot;@id/buttonAdd&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/buttonMul&quot;
        android:text=&quot;×&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F0FFFF&quot;
        android:layout_alignParentRight=&quot;true&quot;
        android:layout_above=&quot;@id/buttonSign&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;

    &lt;Button
        android:id=&quot;@+id/buttonDiv&quot;
        android:text=&quot;÷&quot;
        android:layout_alignParentRight=&quot;true&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F0FFFF&quot;
        android:layout_above=&quot;@id/buttonMul&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;

    &lt;Button
        android:id=&quot;@+id/buttonDot&quot;
        android:text=&quot;.&quot;
        android:layout_alignParentBottom=&quot;true&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#FFFAF0&quot;
        android:layout_toLeftOf=&quot;@id/buttonDiv&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/button3&quot;
        android:text=&quot;3&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_above=&quot;@id/buttonDot&quot;
        android:layout_toLeftOf=&quot;@id/buttonDiv&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/button6&quot;
        android:text=&quot;6&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_above=&quot;@+id/button3&quot;
        android:layout_toLeftOf=&quot;@id/buttonDiv&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/button9&quot;
        android:text=&quot;9&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_above=&quot;@+id/button6&quot;
        android:layout_toLeftOf=&quot;@id/buttonDiv&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/buttonBack&quot;
        android:text=&quot;删除&quot;
        android:textSize=&quot;23sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_above=&quot;@+id/button9&quot;
        android:layout_toLeftOf=&quot;@id/buttonDiv&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;

    &lt;Button
        android:id=&quot;@+id/button0&quot;
        android:text=&quot;0&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_alignParentBottom=&quot;true&quot;
        android:layout_toLeftOf=&quot;@id/buttonDot&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/button2&quot;
        android:text=&quot;2&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_above=&quot;@id/button0&quot;
        android:layout_toLeftOf=&quot;@id/button3&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/button5&quot;
        android:text=&quot;5&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_above=&quot;@+id/button2&quot;
        android:layout_toLeftOf=&quot;@id/button6&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/button8&quot;
        android:text=&quot;8&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_above=&quot;@+id/button5&quot;
        android:layout_toLeftOf=&quot;@id/button9&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/buttonRightBracket&quot;
        android:text=&quot;)&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_above=&quot;@+id/button8&quot;
        android:layout_toLeftOf=&quot;@id/buttonBack&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;

    &lt;Button
        android:id=&quot;@+id/buttonAC&quot;
        android:text=&quot;AC&quot;
        android:layout_alignParentBottom=&quot;true&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#FFFAF0&quot;
        android:layout_toLeftOf=&quot;@id/button0&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;

    &lt;Button
        android:id=&quot;@+id/button1&quot;
        android:text=&quot;1&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_above=&quot;@id/button0&quot;
        android:layout_toLeftOf=&quot;@id/button2&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/button4&quot;
        android:text=&quot;4&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_above=&quot;@+id/button1&quot;
        android:layout_toLeftOf=&quot;@id/button5&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/button7&quot;
        android:text=&quot;7&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_above=&quot;@+id/button4&quot;
        android:layout_toLeftOf=&quot;@id/button8&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;Button
        android:id=&quot;@+id/buttonLeftBracket&quot;
        android:text=&quot;(&quot;
        android:textSize=&quot;25sp&quot;
        android:background=&quot;#F5F5F5&quot;
        android:layout_above=&quot;@+id/button7&quot;
        android:layout_toLeftOf=&quot;@id/buttonRightBracket&quot;
        app:layout_widthPercent=&quot;25%&quot;
        app:layout_heightPercent=&quot;15%&quot;
        /&gt;
    &lt;TextView
        android:id=&quot;@+id/textView&quot;
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;0dp&quot;
        app:layout_widthPercent=&quot;100%&quot;
        app:layout_heightPercent=&quot;25%&quot;
        android:layout_above=&quot;@+id/buttonLeftBracket&quot;
        android:background=&quot;#FFFAFA&quot;
        android:gravity=&quot;bottom|right&quot;
        android:text=&quot;&quot;
        android:textColor=&quot;#292421&quot;
        android:textSize=&quot;30dp&quot;


        /&gt;



&lt;/android.support.percent.PercentRelativeLayout&gt;
</code></pre><h4 id="4隐藏自带标题">4.隐藏自带标题</h4>
<ul>
<li>修改app/src/main/res/values/styles.xml文件 修改内容如下：</li>
</ul>
<pre><code>&lt;resources&gt;

    &lt;!-- Base application theme. --&gt;
    &lt;style name=&quot;AppTheme&quot; parent=&quot;Theme.AppCompat.Light.DarkActionBar&quot;&gt;
        &lt;!-- Customize your theme here. --&gt;
        &lt;item name=&quot;windowActionBar&quot;&gt;false&lt;/item&gt;
        &lt;item name=&quot;windowNoTitle&quot;&gt;true&lt;/item&gt;
    &lt;/style&gt;

&lt;/resources&gt;

</code></pre><h4 id="5修改app图标和名字">5.修改app图标和名字</h4>
<ul>
<li>修改名字
修改app/src/main/res/values/Strings.xml文件 修改内容如下：</li>
</ul>
<pre><code>&lt;resources&gt;
    &lt;string name=&quot;app_name&quot;&gt;冰炭不投de小计算器&lt;/string&gt;
&lt;/resources&gt;

</code></pre><ul>
<li>修改图标</li>
</ul>
<ol>
<li>将图标放在pp/src/main/res/mipmap文件中</li>
<li>修改AndroidManifest.xml文件</li>
</ol>
<pre><code>android:allowBackup=&quot;true&quot;
android:icon=&quot;@mipmap/图片名字&quot; //修改这句
android:label=&quot;@string/app_name&quot;
</code></pre><h3 id="五活动的编写">五.活动的编写</h3>
<h4 id="1-思路">1. 思路</h4>
<ul>
<li>为每个控件起相对应的名字和监控器，点击不同控件触发不同的事件</li>
</ul>
<h4 id="2-计算器中应该考虑的异常并禁止输入">2. 计算器中应该考虑的异常，并禁止输入</h4>
<ul>
<li>小数点不可在一个数字中多次出现</li>
<li>除了*- 和/-之外 其他任意两个符号不可同时出现</li>
<li>负号的处理，负号可以出现在首位，负号可以出现在*/后面</li>
<li>右括号必须小于等于左括号的数量</li>
<li>左括号前不能是数字，右括号后不能是数字</li>
<li>等于时，左右括号数量必须相同，才能输出结果</li>
<li>其他没有考虑到的错误，使用异常抛出错误</li>
</ul>
<h4 id="3其他应该优化的地方">3.其他应该优化的地方</h4>
<ul>
<li>除0</li>
<li>已有符号时，再输入符号时，覆盖之前输入的符号</li>
<li>保存上次计算结果</li>
<li>删除键</li>
<li>清屏键</li>
</ul>
<h4 id="4修改mainacitivy中的代码内容如下">4.修改MainAcitivy中的代码，内容如下</h4>
<pre><code>public class MainActivity extends AppCompatActivity implements View.OnClickListener {

    private TextView textView;
    private StringBuilder pending=new StringBuilder();
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams. FLAG_FULLSCREEN , WindowManager.LayoutParams. FLAG_FULLSCREEN);
        setContentView(R.layout.activity_main);


        textView = (TextView)findViewById(R.id.textView);//类似定义和赋值
        Button button0 = (Button)findViewById(R.id.button0);
        Button button1 = (Button)findViewById(R.id.button1);
        Button button2 = (Button)findViewById(R.id.button2);
        Button button3 = (Button)findViewById(R.id.button3);
        Button button4 = (Button)findViewById(R.id.button4);
        Button button5 = (Button)findViewById(R.id.button5);
        Button button6 = (Button)findViewById(R.id.button6);
        Button button7 = (Button)findViewById(R.id.button7);
        Button button8 = (Button)findViewById(R.id.button8);
        Button button9 = (Button)findViewById(R.id.button9);

        Button buttonAdd = (Button)findViewById(R.id.buttonAdd);
        Button buttonSign = (Button)findViewById(R.id.buttonSign);
        Button buttonMul = (Button)findViewById(R.id.buttonMul);
        Button buttonDiv = (Button)findViewById(R.id.buttonDiv);
        Button buttonEqual = (Button)findViewById(R.id.buttonEqual);
        Button buttonDot= (Button)findViewById(R.id.buttonDot);
        Button buttonRightBracket = (Button)findViewById(R.id.buttonRightBracket);
        Button buttonLeftBracket = (Button)findViewById(R.id.buttonLeftBracket);
        Button buttonBack = (Button)findViewById(R.id.buttonBack);
        Button buttonAC = (Button)findViewById(R.id.buttonAC);

        button0.setOnClickListener(this);//调用监听器
        button1.setOnClickListener(this);
        button2.setOnClickListener(this);
        button3.setOnClickListener(this);
        button4.setOnClickListener(this);
        button5.setOnClickListener(this);
        button6.setOnClickListener(this);
        button7.setOnClickListener(this);
        button8.setOnClickListener(this);
        button9.setOnClickListener(this);

        buttonAdd.setOnClickListener(this);
        buttonSign.setOnClickListener(this);
        buttonMul.setOnClickListener(this);
        buttonDiv.setOnClickListener(this);
        buttonEqual.setOnClickListener(this);
        buttonDot.setOnClickListener(this);
        buttonRightBracket.setOnClickListener(this);
        buttonLeftBracket.setOnClickListener(this);
        buttonBack.setOnClickListener(this);
        buttonAC.setOnClickListener(this);


    }
    @Override
    //监听器
    public void onClick(View v){
        //当前字符串的最后一个和倒数第二个
        int last = 0;
        int last_q =0;
        if(pending.length()!=0)
        {
            last = pending.codePointAt(pending.length()-1);
            if (pending.length()&gt;1)
                last_q =pending.codePointAt(pending.length()-2);
        }
        switch (v.getId()) {
            case R.id.button0:
                if(last!=')'){
                    pending = pending.append(&quot;0&quot;);
                }
                else {
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;0&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.button1:
                if(last!=')'){
                    pending = pending.append(&quot;1&quot;);
                }
                else {
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;1&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.button2:
                if(last!=')'){
                    pending = pending.append(&quot;2&quot;);
                }
                else {
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;2&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.button3:
                if(last!=')'){
                    pending = pending.append(&quot;3&quot;);
                }
                else {
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;3&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.button4:
                if(last!=')'){
                    pending = pending.append(&quot;4&quot;);
                }
                else {
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;4&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.button5:
                if(last!=')'){
                    pending = pending.append(&quot;5&quot;);
                }
                else {
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;5&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.button6:
                if(last!=')'){
                    pending = pending.append(&quot;6&quot;);
                }
                else {
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;6&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.button7:
                if(last!=')'){
                    pending = pending.append(&quot;7&quot;);
                }
                else {
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;7&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.button8:
                if(last!=')'){
                    pending = pending.append(&quot;8&quot;);
                }
                else {
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;8&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.button9:
                if(last!=')'){
                    pending = pending.append(&quot;9&quot;);
                }
                else {
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;9&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.buttonAdd: // +加
                if(last&gt;='0' &amp;&amp;last&lt;='9' ||last==')') {
                    pending = pending.append(&quot;+&quot;);
                }
                else if(pending.length()&gt;1&amp;&amp;last!='('){
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;+&quot;);
                }
                if(pending.length()&gt;1&amp;&amp;last=='-'&amp;&amp;(last_q=='*'||last_q=='/')){
                    pending = pending.replace(pending.length()-2,pending.length(),&quot;+&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.buttonSign:// -减
                if(last&gt;='0' &amp;&amp;last&lt;='9' ||last==')'||last=='*'||last=='/'||pending.length()==0) {
                    pending = pending.append(&quot;-&quot;);
                }
                else  if(pending.length()&gt;1&amp;&amp;last!='('){
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;-&quot;);
                }
                if(pending.length()&gt;1&amp;&amp;last=='-'&amp;&amp;(last_q=='*'||last_q=='/')){
                    pending = pending.replace(pending.length()-2,pending.length(),&quot;-&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.buttonMul: // *乘
                if(last&gt;='0' &amp;&amp;last&lt;='9' ||last==')') {
                    pending = pending.append(&quot;*&quot;);
                }
                else if(pending.length()&gt;1&amp;&amp;last!='(')
                {
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;*&quot;);
                }
                if(pending.length()&gt;1&amp;&amp;last=='-'&amp;&amp;(last_q=='*'||last_q=='/')){
                    pending = pending.replace(pending.length()-2,pending.length(),&quot;*&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.buttonDiv: // /除
                if(last&gt;='0' &amp;&amp;last&lt;='9' ||last==')') {
                    pending = pending.append(&quot;/&quot;);
                }
                else if(pending.length()&gt;1&amp;&amp;last!='('){
                    pending = pending.replace(pending.length()-1,pending.length(),&quot;/&quot;);
                }
                if(last=='-'&amp;&amp;(last_q=='*'||last_q=='/')){
                    pending = pending.replace(pending.length()-2,pending.length(),&quot;/&quot;);
                }
                textView.setText(pending);
                break;
            case R.id.buttonEqual: // =等于
                if((last&gt;='0' &amp;&amp;last&lt;='9' ||last==')')&amp;&amp;judje2()==0) {
                    InfixInToDuffix inf = new InfixInToDuffix();
                        String jieguo;
                        String a=&quot;0&quot;;
                    try {
                        a = inf.toSuffix(pending);
                        jieguo=inf.dealEquation(a);

                    }
                    catch (Exception ex){
                        jieguo = &quot;出错&quot;;
                    }
                    textView.setText(pending+&quot;=&quot;+jieguo);
                    pending = pending.delete(0, pending.length());
                    if(Character.isDigit(jieguo.charAt(0))) {
                        pending = pending.append(jieguo);
                    }
                }
                break;
            case R.id.buttonDot:// 。小数点
                if(last&gt;='0' &amp;&amp;last&lt;='9'&amp;&amp;judje1()) {
                    pending = pending.append(&quot;.&quot;);
                    textView.setText(pending);
                }
                break;
            case R.id.buttonRightBracket:// )右括号
                if((last&gt;='0' &amp;&amp;last&lt;='9'||last==')')&amp;&amp;judje2()==1) {
                    pending = pending.append(&quot;)&quot;);
                    textView.setText(pending);
                }
                break;
            case R.id.buttonLeftBracket:// （左括号
                if((last&lt;'0' ||last&gt;'9')&amp;&amp;last!='.'&amp;&amp;last!=')') {
                    pending = pending.append(&quot;(&quot;);
                    textView.setText(pending);
                }
                break;
            case R.id.buttonBack: //删除
                if(pending.length()!=0) {
                    pending = pending.delete(pending.length()-1,pending.length());
                    textView.setText(pending);
                }
                break;
            case R.id.buttonAC: //清空
                    pending = pending.delete(0, pending.length());
                    textView.setText(pending);
                break;
            default:
                break;
        }
    }
    private boolean judje1(){
        String a=&quot;+-*/().&quot;;
        int[] b = new int[a.length()];
        int max;
        for (int i = 0;i &lt; a.length();i++ )
        {
            String c =&quot;&quot;+a.charAt(i);
            b[i] = pending.lastIndexOf(c);
        }
        Arrays.sort(b);
        if(b[a.length()-1]==-1){
            max = 0;
        }
        else{
            max = b[a.length()-1];
        }
        if(pending.indexOf(&quot;.&quot;,max)==-1){
            return true;
        }
        else{
            return false;}
    }
    private int judje2(){
        int a=0,b=0;
        for(int i = 0 ; i &lt; pending.length() ;i++){
            if(pending.charAt(i)=='(' ) {
                a++;
            }
            if(pending.charAt(i)==')' ) {
                b++;
            }
        }
        if(a == b)
            return 0;
        if(a &gt; b)
            return 1;
        return 2;
    }

}
</code></pre><h3 id="六算法部分">六.算法部分</h3>
<h4 id="1-后缀表达式是什么和计算链接httpwwwnowamagicnetlibrarysvedadetail2306">1. 后缀表达式是什么和计算：<a href="http://www.nowamagic.net/librarys/veda/detail/2306">链接</a></h4>
<h4 id="2-中缀缀表达式常见的表达式转换成后缀表达式的方法链接httpwwwnowamagicnetlibrarysvedadetail2307">2. 中缀缀表达式(常见的表达式)转换成后缀表达式的方法：<a href="http://www.nowamagic.net/librarys/veda/detail/2307">链接</a></h4>
<h4 id="3在项目中新建一个infixintoduffix的java文件编写代码如下">3.在项目中新建一个InfixInToDuffix的java文件编写代码，如下</h4>
<pre><code>public class InfixInToDuffix {

    //使用集合定义好符号的运算优先级别
    private static final Map&lt;Character,Integer&gt;basic =new HashMap&lt;Character, Integer&gt;();
    static {
        basic.put('-',1);
        basic.put('+', 1);
        basic.put('*', 2);
        basic.put('/', 2);
        basic.put('(', 0);//在运算中  （）的优先级最高，但是此处因程序中需要 故设置为0
    }


    //将中缀表达式转换为后缀表达式
    public String toSuffix(StringBuilder infix){
        List&lt;String&gt; queue = new ArrayList&lt;String&gt;();                                    //定义队列  用于存储 数字  以及最后的  后缀表达式
        List&lt;Character&gt; stack = new ArrayList&lt;Character&gt;();                             //定义栈    用于存储  运算符  最后stack中会被 弹空

        char[] charArr = infix.substring(0,infix.length()).trim().toCharArray();                                    //字符数组  用于拆分数字或符号
        String standard = &quot;*/+-()&quot;;                                                        //判定标准 将表达式中会出现的运算符写出来
        char ch = '&amp;';                                                                    //在循环中用来保存 字符数组的当前循环变量的  这里仅仅是初始化一个值  没有意义
        int len = 0;                                                                 //用于记录字符长度 【例如100*2,则记录的len为3 到时候截取字符串的前三位就是数字】
        for (int i = 0; i &lt; charArr.length; i++) {//开始迭代
            int last=0;
            if(i&gt;0) {
                 last = charArr[i-1];
            }
            ch = charArr[i];                                                            //保存当前迭代变量
            if(Character.isDigit(ch)) {                                                    //如果当前变量为 数字
                len++;
            }else if(ch == '.'){                                                        //如果当前变量为  .  会出现在小数里面
                len++;
            }else if(ch == '-' &amp;&amp; (last =='*'||last=='/'||i==0)){                                                        //如果当前变量为  .  会出现在小数里面
                len++;
                continue;
            }else if(standard.indexOf(ch) != -1) {                                        //如果是上面标准中的 任意一个符号
                if(len &gt; 0) {                                                            //长度也有
                    queue.add(String.valueOf(Arrays.copyOfRange(charArr, i - len, i)));    //说明符号之前的可以截取下来做数字
                    len = 0;                                                            //长度置空
                }
                if(ch == '(') {                                                            //如果是左括号
                    stack.add(ch);                                                        //将左括号 放入栈中
                    continue;                                                            //跳出本次循环  继续找下一个位置
                }

                if (!stack.isEmpty()) {                                                    //如果栈不为empty
                    int size = stack.size() - 1;                                        //获取栈的大小-1  即代表栈最后一个元素的下标
                    boolean flag = false;                                                //设置标志位
                    while (size &gt;= 0 &amp;&amp; ch == ')' &amp;&amp; stack.get(size) != '(') {            //若当前ch为右括号，则 栈里元素从栈顶一直弹出，直到弹出到 左括号
                        queue.add(String.valueOf(stack.remove(size)));                    //注意此处条件：ch并未入栈，所以并未插入队列中；同样直到找到左括号的时候，循环结束了，所以左括号也不会放入队列中【也就是：后缀表达式中不会出现括号】
                        size--;                                                            //size-- 保证下标永远在栈最后一个元素【栈中概念：指针永远指在栈顶元素】
                        flag = true;                                                    //设置标志位为true  表明一直在取（）中的元素
                    }
                    if(ch==')'&amp;&amp;stack.get(size) == '('){
                        flag = true;
                    }
                    while (size &gt;= 0 &amp;&amp; !flag &amp;&amp; basic.get(stack.get(size)) &gt;= basic.get(ch)) {    //若取得不是（）内的元素，并且当前栈顶元素的优先级&gt;=对比元素 那就出栈插入队列
                        queue.add(String.valueOf(stack.remove(size)));                    //同样  此处也是remove()方法，既能得到要获取的元素，也能将栈中元素移除掉
                        size--;
                    }
                }
                if(ch != ')') {                                                            //若当前元素不是右括号
                    stack.add(ch);                                                        //就要保证这个符号 入栈
                } else {                                                                //否则就要出栈 栈内符号
                    stack.remove(stack.size() - 1);
                }
            }
            if(i == charArr.length - 1) {                                                //如果已经走到了  中缀表达式的最后一位
                if(len &gt; 0) {                                                            //如果len&gt;0  就截取数字
                    queue.add(String.valueOf(Arrays.copyOfRange(charArr, i - len+1, i+1)));
                }
                int size = stack.size() - 1;                                            //size表示栈内最后一个元素下标
                while (size &gt;= 0) {                                                        //一直将栈内  符号全部出栈 并且加入队列中  【最终的后缀表达式是存放在队列中的，而栈内最后会被弹空】
                    queue.add(String.valueOf(stack.remove(size)));
                    size--;
                }
            }

        }
        String a = queue.toString();
        return a.substring(1,a.length()-1);
    }


    public String dealEquation(String equation){

        String [] arr = equation.split(&quot;, &quot;);                                    //根据, 拆分字符串
        List&lt;String&gt; list = new ArrayList&lt;String&gt;();                            //用于计算时  存储运算过程的集合【例如list中当前放置  100   20  5  /  则取出20/5 最终将结果4存入list   此时list中结果为  100  4 】


        for (int i = 0; i &lt; arr.length; i++) {                                    //此处就是上面说的运算过程， 因为list.remove的缘故，所以取出最后一个数个最后两个数  都是size-2
            int size = list.size();
            switch (arr[i]) {
                case &quot;+&quot;: double a = Double.parseDouble(list.remove(size-2))+ Double.parseDouble(list.remove(size-2)); list.add(String.valueOf(a));     break;
                case &quot;-&quot;: double b = Double.parseDouble(list.remove(size-2))- Double.parseDouble(list.remove(size-2)); list.add(String.valueOf(b));     break;
                case &quot;*&quot;: double c = Double.parseDouble(list.remove(size-2))* Double.parseDouble(list.remove(size-2)); list.add(String.valueOf(c));     break;
                case &quot;/&quot;: double d = Double.parseDouble(list.remove(size-2))/ Double.parseDouble(list.remove(size-2)); list.add(String.valueOf(d));       break;
                default: list.add(arr[i]);     break;                                    //如果是数字  直接放进list中
            }
        }

        return list.size() == 1 ? list.get(0) : &quot;运算失败&quot; ;                    //最终list中仅有一个结果，否则就是算错了
    }

}
</code></pre><h3 id="七-更新优化">七 更新优化</h3>
<p>在之后的陆续测试中，由学长发现其中的不足之处，对于浮点数的计算，容易发生精度丢失，比如说3*1.3=3.900000000000000000001，对于这种情况我使用了BigDecimal类对运算进行了改进。更改后代码如下（只更改了InfixInToDuffix类下的dealEquation方法）</p>
<pre><code>public String dealEquation(String equation){

        String [] arr = equation.split(&quot;, &quot;);                                    //根据, 拆分字符串
        List&lt;String&gt; list = new ArrayList&lt;String&gt;();                            //用于计算时  存储运算过程的集合【例如list中当前放置  100   20  5  /  则取出20/5 最终将结果4存入list   此时list中结果为  100  4 】


        for (int i = 0; i &lt; arr.length; i++) {                                    //此处就是上面说的运算过程， 因为list.remove的缘故，所以取出最后一个数个最后两个数  都是size-2
            int size = list.size();
            switch (arr[i]) {
                case &quot;+&quot;: BigDecimal a = new BigDecimal(list.remove(size-2)).add(new BigDecimal(list.remove(size-2))); list.add(String.valueOf(a));     break;
                case &quot;-&quot;: BigDecimal b = new BigDecimal(list.remove(size-2)).subtract(new BigDecimal(list.remove(size-2))); list.add(String.valueOf(b));     break;
                case &quot;*&quot;: BigDecimal c = new BigDecimal(list.remove(size-2)).multiply(new BigDecimal(list.remove(size-2))); list.add(String.valueOf(c));     break;
                case &quot;/&quot;: BigDecimal d = new BigDecimal(list.remove(size-2)).divide(new BigDecimal(list.remove(size-2)),10,BigDecimal.ROUND_HALF_UP); list.add(String.valueOf(d));       break;
                default: list.add(arr[i]);     break;                                    //如果是数字  直接放进list中
            }
        }

        return list.size() == 1 ? list.get(0) : &quot;运算失败&quot; ;                    //最终list中仅有一个结果，否则就是算错了
    }

</code></pre>
        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>原文作者：</strong><a rel="author" href="http://blog.bingtan.online">冰炭不投day</a></li>
        <li style="word-break:break-all"><strong>原文链接：</strong><a href="http://blog.bingtan.online/posts/Android/Android%E5%B0%8F%E9%A1%B9%E7%9B%AE-%E5%86%B0%E7%82%AD%E4%B8%8D%E6%8A%95de%E5%B0%8F%E8%AE%A1%E7%AE%97%E5%99%A8/">http://blog.bingtan.online/posts/Android/Android%E5%B0%8F%E9%A1%B9%E7%9B%AE-%E5%86%B0%E7%82%AD%E4%B8%8D%E6%8A%95de%E5%B0%8F%E8%AE%A1%E7%AE%97%E5%99%A8/</a></li>
        <li><strong>版权声明：</strong>本作品采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li>
    </ul>
</div>
<br/>



        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/Android/Android%E5%B0%8F%E9%A1%B9%E7%9B%AE%E8%81%8A%E5%A4%A9%E5%AE%A4UI%E7%AF%87/">Android小项目————聊天室（UI篇）</a></li>
        
        <li><a href="/posts/Android/Android%E5%BD%95%E9%9F%B3%E4%B8%8BAudioRecord%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">Android录音下————AudioRecord源码分析</a></li>
        
        <li><a href="/posts/Android/Android%E5%BD%95%E9%9F%B3%E4%B8%8AAudioRecord%E5%AE%9E%E7%8E%B0%E5%BD%95%E9%9F%B3%E5%8A%9F%E8%83%BD/">Android录音上————AudioRecord实现录音功能</a></li>
        
        <li><a href="/posts/Android/Android-MVP%E5%BA%94%E7%94%A8/">Android MVP应用程序</a></li>
        
        <li><a href="/posts/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%8426%E6%9C%89%E5%BA%8F%E8%A1%A8%E6%9F%A5%E6%89%BE/">数据结构26————有序表查找</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='http://blog.bingtan.online/tags/Android'>Android</a></li>
                
                <li><a href='http://blog.bingtan.online/tags/%E5%B0%8F%E9%A1%B9%E7%9B%AE'>小项目</a></li>
                
            </ul>
            
        </div>
    </article>
    
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yourdiscussshortname" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "https://github.com/hsc396612325/HSCBlog/tree/gh-pages"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='http://blog.bingtan.online/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="http://blog.bingtan.online">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>

    
    <section class="widget">
        <h3 class="widget-title">文章目录</h3>
<ul class="widget-list">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#一前言">一.前言</a></li>
    <li><a href="#二环境准备和所需知识点">二.环境准备和所需知识点</a>
      <ul>
        <li><a href="#1-编译器andriod-studio">1. 编译器：Andriod Studio</a></li>
        <li><a href="#2-新建一个项目并选择全部默认">2. 新建一个项目并选择全部默认</a></li>
        <li><a href="#3-知识点">3. 知识点：</a></li>
      </ul>
    </li>
    <li><a href="#三实现效果和界面运行截图">三.实现效果和界面，运行截图</a>
      <ul>
        <li><a href="#1实现效果">1.实现效果：</a></li>
        <li><a href="#2效果截图">2.效果截图</a></li>
      </ul>
    </li>
    <li><a href="#四界面的编写">四.界面的编写</a>
      <ul>
        <li><a href="#1布局">1.布局</a></li>
        <li><a href="#2关于颜色搭配推荐一个网站网站地址httpwwwcnblogscomandroid100pandroid-setalphahtml">2.关于颜色搭配，推荐一个网站网站地址</a></li>
        <li><a href="#3界面的编写">3.界面的编写</a></li>
        <li><a href="#4隐藏自带标题">4.隐藏自带标题</a></li>
        <li><a href="#5修改app图标和名字">5.修改app图标和名字</a></li>
      </ul>
    </li>
    <li><a href="#五活动的编写">五.活动的编写</a>
      <ul>
        <li><a href="#1-思路">1. 思路</a></li>
        <li><a href="#2-计算器中应该考虑的异常并禁止输入">2. 计算器中应该考虑的异常，并禁止输入</a></li>
        <li><a href="#3其他应该优化的地方">3.其他应该优化的地方</a></li>
        <li><a href="#4修改mainacitivy中的代码内容如下">4.修改MainAcitivy中的代码，内容如下</a></li>
      </ul>
    </li>
    <li><a href="#六算法部分">六.算法部分</a>
      <ul>
        <li><a href="#1-后缀表达式是什么和计算链接httpwwwnowamagicnetlibrarysvedadetail2306">1. 后缀表达式是什么和计算：链接</a></li>
        <li><a href="#2-中缀缀表达式常见的表达式转换成后缀表达式的方法链接httpwwwnowamagicnetlibrarysvedadetail2307">2. 中缀缀表达式(常见的表达式)转换成后缀表达式的方法：链接</a></li>
        <li><a href="#3在项目中新建一个infixintoduffix的java文件编写代码如下">3.在项目中新建一个InfixInToDuffix的java文件编写代码，如下</a></li>
      </ul>
    </li>
    <li><a href="#七-更新优化">七 更新优化</a></li>
  </ul>
</nav>
</ul>
    </section>
    

    

    

    
   
    

    

    
    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="http://blog.bingtan.online/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
    <footer id="footer">
    <div class="container">
        &copy; 2020 <a href="http://blog.bingtan.online">冰炭不投day的博客 By 冰炭不投day</a>.
        Powered by <a rel="nofollow noreferer noopener" href="https://gohugo.io" target="_blank">Hugo</a>.
        <a href="https://www.flysnow.org/" target="_blank">Theme</a> based on <a href="https://github.com/flysnow-org/maupassant-hugo" target="_blank">maupassant</a>.
        
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>


<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




    <script src='/js/douban.js'></script>

</body>

</html>